Данный репозиторий содержит портированный код агента E-Sapa. OilService был заменен SunpApi.
Для запуска необходимо:
1. Заполнить конфигурацию objectSettings.json
2. Сбилдить проект
3. Заменить в install.bat путь до exe-исполняемого файла
4. Запустить install.bat от имени администратора, обратите внимание - служба примет название папки, в котором лежат файлы агента
5. Найти сервис в Диспетчер задач->Службы->(название службы)->Запуск
6. Отслеживать логи в папке с exe по пути /logs/дата_лога.log

Приложение работает следующим образом:
1. Запрос отчета по хранению с КПУ
2. Запрос отчета по поставкам с КПУ
3. Создание задачи с данными хранения/поставки в локальную базу SQLite
4. Отправка данных
5. В случае принятия сервером данных, задача удаляется
6. В случае непринятия данных сервером (HTTP 500), повтор через заданное время
7. В случае непринятия данных сервером (HTTP 200, Success=false), статус задачи Abandon

Пожалуйста, адаптируйте код свои бизнес требования